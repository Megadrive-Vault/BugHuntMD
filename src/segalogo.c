/*
    ORIGINAL CODE BY @MoonWatcherMD
    ORIGINAL SEGA PIXEL LOGO FROM Ichidant-R GAME

    MODIFIED BY @Nolddor ( 22-12-2014 )
    - Add Seeeeega Voice
    - Minor bugfixes
*/


#include <genesis.h>
#include "../res/rescomp.h"
#include "../inc/segalogo.h"
#include "../inc/musicvgm.h"


#define MAX_FRAMES 37


typedef struct
{
    const u16 pal[16];
    u16 delay;

} _tFrame;


const _tFrame gif[MAX_FRAMES] =
{
	//   UNUSED       1       2       3       4       5       6       7       8  UNUSED      10      11      12      13      14      15   DELAY
   {  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  30 }, // 00
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0FFF, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0777, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0FFF, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0333, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0333, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0333, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0fff, 0x0777, 0x0333, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0777, 0x0333, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0333, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  30 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0EA0 },   6 }, // 10
	{  { 0x0000, 0x0000, 0x0000, 0x0EA0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0E60 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0E60, 0x0000, 0x0EA0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0A20 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0A20, 0x0000, 0x0E60, 0x0000, 0x0EA0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0600, 0x0000, 0x0A20, 0x0EA0, 0x0E60, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0EA0, 0x0600, 0x0E60, 0x0A20, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0000, 0x0EA0, 0x0000, 0x0E60, 0x0000, 0x0A20, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0EA0, 0x0E60, 0x0000, 0x0A20, 0x0000, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0E60, 0x0A20, 0x0000, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0A20, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 },
	{  { 0x0000, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },   6 }, // 20
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  30 },
	{  { 0x0000, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0200 },   6 },
	{  { 0x0000, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0400 },   6 },
	{  { 0x0000, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0600, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0600, 0x0600, 0x0900, 0x0920, 0x0920, 0x0920, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0600, 0x0900, 0x0920, 0x0B20, 0x0940, 0x0B70, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0B70, 0x0D90, 0x0222, 0x0000, 0x0222, 0x0222, 0x0222, 0x0222, 0x0222, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0E90, 0x0EB0, 0x0333, 0x0000, 0x0333, 0x0333, 0x0333, 0x0333, 0x0333, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0444, 0x0000, 0x0444, 0x0444, 0x0444, 0x0444, 0x0444, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0676, 0x0000, 0x0676, 0x0676, 0x0676, 0x0676, 0x0676, 0x0600 },   6 }, // 30
	{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0999, 0x0000, 0x0999, 0x0999, 0x0999, 0x0999, 0x0999, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0DDD, 0x0000, 0x0DDD, 0x0DDD, 0x0DDD, 0x0DDD, 0x0DDD, 0x0600 },   6 },
	{  { 0x0000, 0x0600, 0x0900, 0x0B20, 0x0D40, 0x0F70, 0x0D90, 0x0FB0, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0FFF, 0x0600 }, 240 },
	{  { 0x0000, 0x0400, 0x0400, 0x0600, 0x0920, 0x0940, 0x0940, 0x0970, 0x0999, 0x0999, 0x0999, 0x0999, 0x0999, 0x0999, 0x0999, 0x0400 },   6 },
	{  { 0x0000, 0x0200, 0x0200, 0x0400, 0x0400, 0x0620, 0x0420, 0x0640, 0x0676, 0x0676, 0x0676, 0x0676, 0x0676, 0x0676, 0x0676, 0x0200 },   6 },
	{  { 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000 },  30 }
};


void _segalogo( void )
{
   VDP_waitVSync();

   //LOAD LOGO IN BLACK PALETTE
   SYS_disableInts();
   VDP_setEnable(FALSE);
       VDP_drawImageEx(BPLAN, &sega, TILE_ATTR_FULL(PAL0, TRUE, FALSE, FALSE, TILE_USERINDEX), 0, 0, TRUE, FALSE);
   VDP_setEnable(TRUE);
   SYS_enableInts();


   VDP_waitVSync();


   //MAIN LOOP - PALETTE UPDATE
   u8 frame;
   for ( frame=0; frame<MAX_FRAMES; frame++ )
	{
		VDP_setPalette( PAL0, gif[frame].pal );

      u8 i;
		for( i=0; i<gif[frame].delay; i++ )
      {
         VDP_waitVSync();
      }

      if (frame == 21) { musicvgm_play(MUSICVGM_SEGA); }
	}
}
